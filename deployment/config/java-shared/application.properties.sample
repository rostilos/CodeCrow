# ============================================================================
# JWT and Security Configuration
# ============================================================================
# App Properties
codecrow.security.jwtSecret=change-me-to-a-random-secret
codecrow.security.projectJwtExpirationMs=7776000000
#codecrow.security.jwtExpirationMs=86400000
#codecrow.security.refreshTokenExpirationMs=604800000
#3 months - default value

#Crypt key + Old key if was rotated
codecrow.security.encryption-key-old=change-me-to-a-random-secret
codecrow.security.encryption-key=change-me-to-a-random-secret

# Internal API secret for service-to-service communication (inference-orchestrator to web-server)
# Must match INTERNAL_API_SECRET env var in inference-orchestrator container
codecrow.internal.api.secret=codecrow-internal-secret-change-me

# Shared secret for authenticating requests to RAG pipeline
# Must match SERVICE_SECRET in rag-pipeline and inference-orchestrator .env files
codecrow.rag.api.secret=change-me-to-a-random-secret


# ============================================================================
# Spring MVC and Multipart Configuration
# ============================================================================
springdoc.swagger-ui.operationsSorter=method
springdoc.swagger-ui.path=/swagger-ui-custom.html
springdoc.api-docs.path=/api-docs


spring.servlet.multipart.max-file-size=500MB
spring.servlet.multipart.max-request-size=500MB
spring.mvc.async.request-timeout = -1

# Logging configuration
logging.level.org.springframework.security.web.access.ExceptionTranslationFilter=ERROR
logging.level.org.apache.catalina.core.ApplicationDispatcher=ERROR
logging.level.org.apache.catalina.core.StandardHostValve=ERROR

# HikariCP Connection Pool Configuration
# Maximum time to wait for a connection from the pool (30 seconds)
spring.datasource.hikari.connection-timeout=30000
# Maximum lifetime of a connection in the pool (30 minutes)
spring.datasource.hikari.max-lifetime=1800000
# Maximum idle time for a connection (10 minutes)
spring.datasource.hikari.idle-timeout=600000
# Minimum number of idle connections
spring.datasource.hikari.minimum-idle=5
# Maximum pool size
spring.datasource.hikari.maximum-pool-size=20
# How often to validate idle connections (5 minutes)
spring.datasource.hikari.keepalive-time=300000
# Timeout for removing leaked connections (2 minutes) - helps detect 'idle in transaction' issues
spring.datasource.hikari.leak-detection-threshold=120000

# Debug logging for authentication issues
logging.level.org.rostilos.codecrow.security=DEBUG
logging.level.org.springframework.security.web.FilterChainProxy=DEBUG
logging.level.org.springframework.web.cors=DEBUG

# Completely disable Hibernate SQL output
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.show_sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.use_sql_comments=false
logging.level.org.hibernate=ERROR
logging.level.org.hibernate.SQL=OFF
logging.level.org.hibernate.type=OFF
logging.level.org.hibernate.type.descriptor.sql=OFF
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=OFF
logging.level.org.hibernate.orm.jdbc.bind=OFF

# ============================================================================
# RAG
# ============================================================================
#codecrow.rag.api.url=http://rag-pipeline:8001
#codecrow.rag.api.enabled=true

# RAG API timeouts (in seconds)
#codecrow.rag.api.timeout.connect=30
#codecrow.rag.api.timeout.read=120
# RAG indexing timeout - 4 hours for large repositories
#codecrow.rag.api.timeout.indexing=14400

# Analysis Lock Configuration
# Lock timeout - maximum time for a single analysis to hold a lock (in minutes)
#analysis.lock.timeout.minutes=30
# RAG indexing lock timeout - longer timeout for RAG indexing operations (in minutes, default 6 hours)
#analysis.lock.rag.timeout.minutes=360
# Lock wait timeout - maximum time to wait for a lock to be released (in minutes)
#analysis.lock.wait.timeout.minutes=5
# Lock retry interval - time to wait between lock acquisition retries (in seconds)
#analysis.lock.wait.retry.interval.seconds=5
# Lock cleanup interval - how often to clean up expired locks (in milliseconds)
#analysis.lock.cleanup.interval.ms=300000


# ============================================================================
# Cross-service deps
# ============================================================================
## Application name (used in emails and 2FA setup)
#codecrow.app.name=CodeCrow

# Public Frontend URL (for redirects after OAuth)
#codecrow.frontend-url=http://localhost:8080

## Public WEB SERVER URL (API server - used for OAuth callbacks)
#codecrow.web.base.url=http://localhost:8081

## Public Webhook base URL (if different from codecrow.base-url, for pipeline agent webhooks)
#codecrow.webhook.base-url=http://localhost:8082

## Internal INFERENCE ORCHESTRATOR URL
#codecrow.inference.orchestrator.url=http://inference-orchestrator:8000/review


# ============================================================================
# EMAIL / SMTP CONFIGURATION
# ============================================================================
# IMPORTANT: Configure these settings to enable email functionality
# including 2FA email verification, notifications, and password reset.
#
# For production, use a reliable SMTP provider:
# - Amazon SES (recommended for AWS deployments)
# - SendGrid (easy setup, good deliverability)
# - Mailgun (developer-friendly)
# - Gmail SMTP (for testing only, has daily limits)
# - Microsoft 365 / Office 365
# - Your own mail server (requires proper SPF/DKIM/DMARC setup)
#
# ============================================================================

# Enable/disable email sending (set to true and configure SMTP below to enable)
# The platform works fully without email â€” password reset and email 2FA will be
# unavailable, but TOTP-based 2FA and all other features work normally.
#codecrow.email.enabled=false

# Sender email address and display name
#codecrow.email.from=noreply@codecrow.io
#codecrow.email.from-name=CodeCrow

# Application name used in email templates
#codecrow.email.app-name=CodeCrow

# SMTP Server Configuration
# Replace these placeholders with your actual SMTP credentials
#spring.mail.host=<SMTP_HOST>
#spring.mail.port=587
#spring.mail.username=<SMTP_USERNAME>
#spring.mail.password=<SMTP_PASSWORD>

# SMTP Properties
#spring.mail.properties.mail.smtp.auth=true
#spring.mail.properties.mail.smtp.starttls.enable=true
#spring.mail.properties.mail.smtp.starttls.required=true
#spring.mail.properties.mail.smtp.connectiontimeout=5000
#spring.mail.properties.mail.smtp.timeout=5000
#spring.mail.properties.mail.smtp.writetimeout=5000


# ============================================================================
# Google Oauth Configuration
# ============================================================================
# Google OAuth Configuration (for social login)
# Create OAuth 2.0 Client ID in Google Cloud Console:
# 1. Go to https://console.cloud.google.com/apis/credentials
# 2. Create OAuth 2.0 Client ID (Web application)
# 3. Add authorized JavaScript origins: your frontend URL (e.g., http://localhost:8080)
# 4. Add authorized redirect URIs: your frontend URL (e.g., http://localhost:8080)
# 5. Copy the Client ID below

#codecrow.oauth.google.client-id=
# ============================================================================

# ============================================================================
# LLM Model List Sync Configuration
# ============================================================================
# Sync schedule cron expression (default: daily at midnight)
#llm.sync.cron=0 0 0 * * *
# Minimum context window for models to be included (default: 50000 tokens)
#llm.sync.min-context-window=50000
# Provider API keys (optional - some providers allow listing without auth)
# For OpenRouter: optional, improves rate limits
#llm.sync.openrouter.api-key=
# For OpenAI: required for dynamic model list, falls back to static list without
#llm.sync.openai.api-key=
# For Google: required for dynamic model list, falls back to static list without
#llm.sync.google.api-key=
# For Anthropic: not used (static list, no public API for model listing)
#llm.sync.anthropic.api-key