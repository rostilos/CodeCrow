AI_CLIENT_PORT=8000
RAG_ENABLED=true
RAG_API_URL=http://host.docker.internal:8001

# === Service-to-Service Auth ===
# Shared secret for authenticating requests between internal services.
# Must match the SERVICE_SECRET configured on rag-pipeline.
# Leave empty to disable auth (dev mode only).
# IMPORTANT: Avoid $ { } characters in the secret â€” they can cause dotenv parsing issues.
SERVICE_SECRET=change-me-to-a-random-secret

# === Concurrency ===
# Max parallel review requests handled simultaneously (default: 4)
MAX_CONCURRENT_REVIEWS=4

# API access for Platform MCP (internal network only)
CODECROW_API_URL=http://codecrow-web-application:8081

# Platform MCP JAR path
PLATFORM_MCP_JAR=/app/codecrow-platform-mcp-1.0.jar
INTERNAL_API_SECRET=codecrow-internal-secret-change-me

# === LLM Settings ===
# Temperature for code review (0.0 = deterministic, 0.1-0.3 = more creative)
LLM_TEMPERATURE=0.0

# === Direct Review Mode ===
# When rawDiff is provided in request, bypasses MCP agent for faster review
# This is controlled by pipeline-agent sending rawDiff field
# No configuration needed - automatic when rawDiff is present

# === Diff Processing Limits (matching MCP server LargeContentFilter) ===
# Maximum file size in bytes (default: 25KB - same as LargeContentFilter.DEFAULT_SIZE_THRESHOLD_BYTES)
DIFF_MAX_FILE_SIZE=25600
# Maximum files to include in review (default: 100)
DIFF_MAX_FILES=100
# Maximum total diff size in bytes (default: 500KB)
DIFF_MAX_TOTAL_SIZE=500000
# Maximum lines per file (default: 1000)
DIFF_MAX_LINES_PER_FILE=1000

# === LLM Reranking (for large PRs) ===
# Enable LLM-based reranking for large PRs
LLM_RERANK_ENABLED=true
# Minimum files to trigger LLM reranking (default: 20)
LLM_RERANK_THRESHOLD=20
# Max RAG items to rerank via LLM
LLM_RERANK_MAX_ITEMS=15

# === RAG Context Settings ===
# Minimum relevance score for RAG results (0.0-1.0)
RAG_MIN_RELEVANCE_SCORE=0.7
# Default number of RAG chunks to retrieve
RAG_DEFAULT_TOP_K=15
# Cache TTL in seconds
RAG_CACHE_TTL_SECONDS=300
# Max cache entries
RAG_CACHE_MAX_SIZE=100

# === Context Budget (token allocation percentages, must sum to 1.0) ===
CONTEXT_BUDGET_HIGH_PRIORITY_PCT=0.30
CONTEXT_BUDGET_MEDIUM_PRIORITY_PCT=0.40
CONTEXT_BUDGET_LOW_PRIORITY_PCT=0.20
CONTEXT_BUDGET_RAG_PCT=0.10

# === Prompt Logging (Debug) ===
# Enable prompt logging for debugging
PROMPT_LOG_ENABLED=true
# Log full prompts to file
PROMPT_LOG_TO_FILE=true
# Also log to console (verbose)
PROMPT_LOG_TO_CONSOLE=false
# Directory for prompt logs
PROMPT_LOG_DIR=/tmp/codecrow_prompts
# Max log files to keep (auto-cleanup)
PROMPT_LOG_MAX_FILES=50